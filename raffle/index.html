<!DOCTYPE html>
<html lang="en">
<head>
  <title>R2K2 | Active Raffles</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Active raffles for the R2K2 community. Wager to enter and win!" />
  <meta property="og:image" content="/assets/logo.png" />
  <link rel="icon" type="image/png" href="/assets/logo.png" />

  <!-- Optional site CSS (kept untouched) -->
  <link rel="stylesheet" href="/css/app.css" />
  <link rel="stylesheet" href="/css/vendor.css" />
  <link rel="stylesheet" href="/css/toast.css" />

  <style>
    :root{
      --bg-deep:#070b12;         /* page bg */
      --card:#0b0f17;            /* card bg */
      --border:#1b2a40;          /* subtle border */
      --ink:#e9f5ff;             /* text on dark */
      --muted:#a6c9ef;           /* muted text */
      --accent:#6b5cff;          /* purple accent */
      --blue:#1398ff;            /* rainbet blue */
    }

    html,body{background:var(--bg-deep);color:var(--ink);margin:0}

    /* ======= Header (same styling we fixed earlier) ======= */
    #r2kHeader{
      position:sticky; top:0; z-index:2000;
      background:linear-gradient(180deg, rgba(7,10,16,0.98) 0%, rgba(5,8,13,0.98) 85%, rgba(3,5,9,1) 100%);
      backdrop-filter:blur(6px);
      border:none !important;
      box-shadow:0 4px 12px rgba(0,0,0,.4);
    }
    #r2kHeader .h-inner{max-width:1200px;margin:0 auto;padding:14px 20px;display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:16px}
    #r2kHeader .brand{display:flex;align-items:center;gap:10px;text-decoration:none}
    #r2kHeader .brand .logo{width:40px;height:40px;border-radius:50%;object-fit:cover;box-shadow:0 0 12px rgba(19,152,255,.35)}
    #r2kHeader .brand .name{font-size:22px;font-weight:800;color:#fff}
    #r2kHeader .brand .name .accent{color:var(--blue);text-shadow:0 0 10px rgba(19,152,255,.5)}
    #r2kHeader .nav{display:flex;justify-content:center;gap:26px}
    #r2kHeader .nav a, #r2kHeader .nav button{color:#e8f4ff;background:none;border:0;cursor:pointer;text-decoration:none;font-weight:700;font-size:14px;opacity:.92;padding:8px 6px;border-radius:8px;transition:.18s}
    #r2kHeader .nav a:hover, #r2kHeader .nav button:hover{color:#fff;text-shadow:0 0 10px rgba(19,152,255,.45)}
    #r2kHeader .actions{display:flex;justify-content:flex-end;gap:12px}
    #r2kHeader .btn{display:inline-flex;align-items:center;gap:8px;font-weight:800;font-size:14px;padding:10px 16px;border-radius:999px;text-decoration:none;border:1px solid rgba(19,152,255,.25);color:#0a1626;background:linear-gradient(90deg,#22b1ff,#1398ff);box-shadow:0 6px 20px rgba(19,152,255,.35),inset 0 0 10px rgba(255,255,255,.08);transition:transform .15s,box-shadow .15s,filter .15s}
    #r2kHeader .btn:hover{transform:translateY(-1px);filter:brightness(1.08);box-shadow:0 8px 26px rgba(19,152,255,.5)}
    #r2kHeader .btn.outline{background:transparent;color:#e8f4ff;border-color:rgba(19,152,255,.45);box-shadow:0 0 16px rgba(19,152,255,.25) inset}
    #r2kHeader .btn.outline:hover{background:rgba(19,152,255,.08);color:#fff}
    #r2kHeader .hamburger{display:none;justify-self:end;cursor:pointer}
    #r2kHeader .hamburger span{display:block;width:24px;height:3px;margin:4px 0;background:#e8f4ff;border-radius:2px}
    #r2kHeader::after{content:"";position:absolute;left:0;right:0;bottom:-4px;height:2px;background:linear-gradient(90deg,rgba(0,0,0,0) 0%,rgba(19,152,255,.45) 20%,rgba(19,152,255,.9) 50%,rgba(19,152,255,.45) 80%,rgba(0,0,0,0) 100%);box-shadow:0 0 18px rgba(19,152,255,.4);pointer-events:none;z-index:100}
    @media (max-width:900px){
      #r2kHeader .h-inner{grid-template-columns:1fr auto auto}
      #r2kHeader .nav{display:none;position:absolute;top:60px;left:0;right:0;background:#080f19;border-top:1px solid rgba(19,152,255,.15);padding:12px 20px;gap:16px;flex-direction:column}
      #r2kHeader .nav.show{display:flex}
      #r2kHeader .hamburger{display:flex}
      #r2kHeader .actions{display:none}
    }

    /* ======= Page layout ======= */
    .wrap{max-width:1200px;margin:0 auto;padding:24px 20px}
    .hero-title{font-weight:900;font-size:42px;text-align:center;margin-top:18px}
    .hero-sub{font-size:14px;color:var(--muted);text-align:center;margin-top:6px}
    .accent{color:#a99dff}

    .grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-top:26px}
    @media (max-width:980px){.grid{grid-template-columns:1fr}}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      padding:20px;
      box-shadow:0 0 24px rgba(107,92,255,.07);
    }
    .card-glow{
      position:relative;
      overflow:hidden;
    }
    .card-glow::before{
      content:"";
      position:absolute;inset:-2px;
      background:radial-gradient(120px 120px at 70px 70px, rgba(125,107,255,.15), transparent 60%),
                 radial-gradient(140px 140px at 85% 20%, rgba(19,152,255,.10), transparent 60%);
      pointer-events:none;
    }

    .prize{font-size:46px;font-weight:900;text-shadow:0 0 14px rgba(255,255,255,.25);text-align:center;margin-top:6px}
    .prize-label{text-align:center;color:var(--muted);font-weight:800;letter-spacing:.08em;margin-top:6px}

    .pill-row{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-top:18px}
    .pill{background:#0c1320;border:1px solid var(--border);border-radius:12px;padding:14px;text-align:center}
    .pill .big{font-weight:900}
    .pill .cap{font-size:12px;color:var(--muted);margin-top:4px}

    .row{display:flex;gap:10px;align-items:center;justify-content:center}
    .stat{background:#0c1320;border:1px solid var(--border);border-radius:12px;padding:14px;text-align:center;margin-top:18px}
    .stat .count{font-weight:900}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      width:100%; padding:14px 16px; border-radius:12px; margin-top:18px;
      border:1px solid #2b2466; background:rgba(107,92,255,.1); color:#f0eaff; font-weight:800; cursor:pointer;
      transition:.18s;
    }
    .btn:hover{filter:brightness(1.07);box-shadow:0 0 18px rgba(107,92,255,.25) inset}
    .btn.alt{border-color:#0f5da1;background:linear-gradient(90deg,#22b1ff,#1398ff);color:#08111a;box-shadow:0 6px 20px rgba(19,152,255,.35)}

    .progress{margin-top:14px}
    .bar{height:12px;background:#081321;border:1px solid var(--border);border-radius:999px;overflow:hidden}
    .fill{height:100%;width:0;background:linear-gradient(90deg,#1398ff,#48c7ff);box-shadow:0 0 12px rgba(0,153,255,.55);transition:width .8s ease}
    .meta{display:flex;justify-content:space-between;font-size:12px;color:var(--muted);margin-top:6px}
    .meta .strong{color:#fff;font-weight:800}

    .tick-icon{
      display:inline-flex;align-items:center;justify-content:center;
      width:60px;height:60px;border-radius:16px;
      background:radial-gradient(60px 60px at 50% 50%, rgba(125,107,255,.22), rgba(125,107,255,.08));
      box-shadow:0 4px 30px rgba(125,107,255,.3) inset, 0 0 20px rgba(125,107,255,.15);
      margin:0 auto 6px;
    }
    .tick-icon svg{width:30px;height:30px;opacity:.95}

    /* Modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:3000}
    .modal .sheet{background:var(--card);border:1px solid var(--border);border-radius:14px;max-width:600px;width:92%;padding:18px}
    .list{max-height:340px;overflow:auto;border:1px dashed var(--border);border-radius:10px;margin-top:10px}
    .list-item{display:flex;justify-content:space-between;padding:10px 12px;border-bottom:1px solid #0f1c2c}
    .list-item:nth-child(odd){background:#0a131f}
    .close-x{background:transparent;border:1px solid var(--border);padding:8px 12px;border-radius:10px;color:#cfe9ff;cursor:pointer}

    /* Tiny helper for small screens */
    @media (max-width:520px){
      .pill-row{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header id="r2kHeader">
    <div class="h-inner">
      <a href="/" class="brand" aria-label="R2K2 Home">
        <img src="/assets/logo.png" class="logo" alt="R2K2">
        <div class="name">R2K<span class="accent">2</span></div>
      </a>

      <nav class="nav" id="r2kNav">
        <a href="/">Home</a>
        <a href="/leaderboard/rainbet">Leaderboard</a>
        <a href="/raffle" aria-current="page">Raffle</a>
      </nav>

      <div class="actions">
        <a class="btn outline" href="/register">Register</a>
        <a class="btn" href="https://rainbet.com/?r=r2k2" target="_blank" rel="noopener">Join Rainbet</a>
      </div>

      <div class="hamburger" id="hamburger" aria-label="Menu" aria-controls="r2kNav" aria-expanded="false">
        <span></span><span></span><span></span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <h1 class="hero-title"><span class="accent">Active</span> Raffles</h1>
    <p class="hero-sub">Wager to automatically enter and win amazing prizes!</p>

    <section class="grid">
      <!-- ===== Card 1: Bonus Buy ===== -->
      <article class="card card-glow" data-id="bonus-buy">
        <div class="tick-icon">
          <!-- gift icon -->
          <svg viewBox="0 0 24 24" fill="#ffffff"><path d="M20 12v8a2 2 0 0 1-2 2h-5v-10h7zm-9 10H6a2 2 0 0 1-2-2v-8h7v10zM4 9h16v2H4V9zm4-7a3 3 0 0 1 3 3v1h-1a3 3 0 0 1-2-5zm8 0a3 3 0 0 1-2 5h-1V5a3 3 0 0 1 3-3z"/></svg>
        </div>
        <div class="prize" id="p1-amount">$60.00</div>
        <div class="prize-label">BONUS BUY (50/50 PROFIT)</div>

        <div class="pill-row">
          <div class="pill">
            <div class="big" id="p1-min">$5,000.00</div>
            <div class="cap">Min Wager</div>
          </div>
          <div class="pill">
            <div class="big" id="p1-remaining">--</div>
            <div class="cap">Remaining (CST)</div>
          </div>
        </div>

        <div class="stat">
          <div class="count" id="p1-participants">15</div>
          <div class="cap">Participants Entered</div>
        </div>

        <div class="progress">
          <div class="bar"><div class="fill" id="p1-fill" style="width:0%"></div></div>
          <div class="meta"><span id="p1-pct">0%</span><span id="p1-meta">$0 / $0</span></div>
        </div>

        <button class="btn" data-open="bonus-buy">‚úì Auto-Entry Enabled<br><span style="font-weight:600">Wager $5,000.00+ to be automatically entered!</span></button>
        <a class="btn alt" href="https://rainbet.com/?r=r2k2" target="_blank" rel="noopener">Join Rainbet</a>

        <button class="btn" data-view="bonus-buy">üë• View Participants</button>
      </article>

      <!-- ===== Card 2: Cash Prize ===== -->
      <article class="card card-glow" data-id="cash-prize">
        <div class="tick-icon">
          <svg viewBox="0 0 24 24" fill="#ffffff"><path d="M20 12v8a2 2 0 0 1-2 2h-5v-10h7zm-9 10H6a2 2 0 0 1-2-2v-8h7v10zM4 9h16v2H4V9zm4-7a3 3 0 0 1 3 3v1h-1a3 3 0 0 1-2-5zm8 0a3 3 0 0 1-2 5h-1V5a3 3 0 0 1 3-3z"/></svg>
        </div>
        <div class="prize" id="p2-amount">$24.99</div>
        <div class="prize-label">CASH PRIZE</div>

        <div class="pill-row">
          <div class="pill">
            <div class="big" id="p2-min">$100.00</div>
            <div class="cap">Min Wager</div>
          </div>
          <div class="pill">
            <div class="big" id="p2-remaining">--</div>
            <div class="cap">Remaining (CST)</div>
          </div>
        </div>

        <div class="stat">
          <div class="count" id="p2-participants">45</div>
          <div class="cap">Participants Entered</div>
        </div>

        <div class="progress">
          <div class="bar"><div class="fill" id="p2-fill" style="width:0%"></div></div>
          <div class="meta"><span id="p2-pct">0%</span><span id="p2-meta">$0 / $0</span></div>
        </div>

        <button class="btn" data-open="cash-prize">‚úì Auto-Entry Enabled<br><span style="font-weight:600">Wager $100.00+ to be automatically entered!</span></button>
        <a class="btn alt" href="https://rainbet.com/?r=r2k2" target="_blank" rel="noopener">Join Rainbet</a>

        <button class="btn" data-view="cash-prize">üë• View Participants</button>
      </article>
    </section>
  </main>

  <!-- Participants Modal -->
  <div class="modal" id="participantsModal" aria-hidden="true">
    <div class="sheet">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 style="margin:0">Participants</h3>
        <button class="close-x" id="closeModal">Close</button>
      </div>
      <div class="list" id="participantsList"></div>
    </div>
  </div>

  <script>
    // Mobile menu toggle (if you add hamburger later)
    (function(){
      const burger=document.getElementById('hamburger');
      const nav=document.getElementById('r2kNav');
      if(burger&&nav){
        burger.addEventListener('click',()=>nav.classList.toggle('show'));
      }
    })();

    // -------- Demo Data + Timers (Replace with your API later) --------
    const raffles = {
      "bonus-buy": {
        prizeUSD: 60.00,
        minWager: 5000,
        endAt: new Date(Date.now() + (2*24+15)*3600*1000).toISOString(), // 2d 15h from now
        participants: 15,
        goalUSD: 6000, // for progress bar demo
        currentUSD: 4200,
        people: Array.from({length:15},(_,i)=>({name:`Player#${i+1}`, tickets: 1}))
      },
      "cash-prize": {
        prizeUSD: 24.99,
        minWager: 100,
        endAt: new Date(Date.now() + (1*24+15)*3600*1000).toISOString(), // 1d 15h from now
        participants: 45,
        goalUSD: 2500,
        currentUSD: 1625,
        people: Array.from({length:45},(_,i)=>({name:`User_${i+1}`, tickets: 1}))
      }
    };

    const $ = (sel)=>document.querySelector(sel);
    const $$ = (sel)=>document.querySelectorAll(sel);

    function money(n){ return n.toLocaleString(undefined,{style:'currency',currency:'USD',maximumFractionDigits:2}); }
    function timeLeft(iso){
      const end = new Date(iso).getTime(), now = Date.now();
      const s = Math.max(0, Math.floor((end-now)/1000));
      const d = Math.floor(s/86400), h = Math.floor((s%86400)/3600), m = Math.floor((s%3600)/60);
      return d>0 ? `${d}d ${h}h` : `${h}h ${m}m`;
    }

    function setFill(idPrefix, current, goal){
      const pct = Math.max(0, Math.min(100, goal? (current/goal)*100 : 0));
      $(`#${idPrefix}-fill`).style.width = pct + '%';
      $(`#${idPrefix}-pct`).textContent = Math.round(pct) + '%';
      $(`#${idPrefix}-meta`).textContent = `${money(current)} / ${money(goal)}`;
    }

    function render(){
      // Card 1
      const r1 = raffles["bonus-buy"];
      $("#p1-amount").textContent = money(r1.prizeUSD);
      $("#p1-min").textContent = money(r1.minWager);
      $("#p1-participants").textContent = r1.participants;
      $("#p1-remaining").textContent = timeLeft(r1.endAt);
      setFill('p1', r1.currentUSD, r1.goalUSD);

      // Card 2
      const r2 = raffles["cash-prize"];
      $("#p2-amount").textContent = money(r2.prizeUSD);
      $("#p2-min").textContent = money(r2.minWager);
      $("#p2-participants").textContent = r2.participants;
      $("#p2-remaining").textContent = timeLeft(r2.endAt);
      setFill('p2', r2.currentUSD, r2.goalUSD);
    }

    // Update countdown every minute
    setInterval(()=>{
      $("#p1-remaining").textContent = timeLeft(raffles["bonus-buy"].endAt);
      $("#p2-remaining").textContent = timeLeft(raffles["cash-prize"].endAt);
    }, 60000);
    render();

    // Participants modal
    const modal = $("#participantsModal");
    const list  = $("#participantsList");
    $("#closeModal").addEventListener('click', ()=> (modal.style.display='none', modal.setAttribute('aria-hidden','true')));

    $$('button[data-view]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('data-view');
        const rows = (raffles[id]?.people || []).map(p=>{
          const name = String(p.name).replace(/[<>]/g,'');
          return `<div class="list-item"><span>${name}</span><span>üéüÔ∏è ${p.tickets||1}</span></div>`;
        }).join('') || `<div class="list-item"><span>No entries yet.</span><span></span></div>`;
        list.innerHTML = rows;
        modal.style.display='flex';
        modal.setAttribute('aria-hidden','false');
      });
    });

    // ‚ÄúAuto-Entry Enabled‚Äù buttons ‚Äì you can swap to rules/info action later
    $$('button[data-open]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('data-open');
        alert('Auto-entry is enabled on wagers that meet the minimum for this raffle.\n\nRaffle: ' + id);
      });
    });
  </script>
</body>
</html>
